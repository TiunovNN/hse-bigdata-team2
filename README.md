# hse-bigdata-team2

## Предварительная настройка

### Настроить ansible
На компьютере должен быть установлен python

```shell
$ python -m venv .venv
$ source .venv/bin/activate
$ python -r requirements.txt
```

Проверяем что ansible готов к работе:

```shell
$ ansible --version
ansible [core 2.17.5]
```

### Настроить ssh

Ко всем узла должен быть настроен ssh.

Например, настройках трех узлов с jump-node `~/.ssh/config`
```config
Host proxy
    HostName 176.109.91.4
    User team

Host node1
    HostName 192.168.1.11
    ProxyJump proxy
    User team

Host node2
    HostName 192.168.1.12
    ProxyJump proxy
    User team

Host node3
    HostName 192.168.1.13
    ProxyJump proxy
    User team
```

### Настроить inventory/hosts.yaml

Если названия нод отличаются от тех, что указаны в [host.yaml](inventory/hosts.yaml), то там нужно подставить правильные названия

Если sudo на хостах требует ввода пароля, то нужно раскоментировать строки `#ansible_become_password: secretpassword` и заменить `secretpassword` на свой

Чтобы убедится, что правильно настроили нужно выполнить следующую команду:

```shell
$ ansible -i inventory -m ping all
```

## Homework 1

### Описание

1. Необходимо развернуть кластер hdfs включающий в себя 3 DataNode. Должны быть запущены и выполняться следующие демоны: NameNode, Secondary NameNode и три DataNode
2. Кластер должен быть развернут на разных виртуальных машинах, которые будут вам предоставлены. Информация о хостах появится в чате курса.
3. Распределение демонов зависит от числа хостов. Более подробная информация будет доступна, когда станет известно количество предоставляемых виртуальных машин.
4. Кластер должен быть целостным, в логах демонов не должно быть сообщений о критических ошибках и они должны быть в работоспособном состоянии
Как понять, что кластер целостный:
Вариант 1. Зайти в интерфейс NameNode в Hadoop. В нем не должны быть деградировавших нод, должны присутстовать 3 работающих DataNode. 
Вариант 2. В логах кластера не должно быть критических ошибок
5. Ограничения по операционной системе: Ubuntu 20 и Debian 10
6. На узлах должно обеспечение по ssh
7. Виртуальные машины будут чистые. Пишите инструкции так, как будто вам нужно научить кого-то разоврачивать кластер.
8. Этот кластер будет использован для выполнения последующих практических заданий

### Запуск настройки

```shell
ansible-playbook -i inventory playbooks/configure_hdfs.yml
```


## Homework 2
Развернуть YARN и опубликовать веб-интерфейсы основных и вспомогательных демонов кластера для внешнего использования.
Поднять yarn с history сервером и опубликовать webui всех датанод, непосредственно кластера и Historyjob сервера, чтобы мы могли их видеть через общий веб интерфейс.

### Запуск настройки

```shell
ansible-playbook -i inventory playbooks/configure_yarn.yml
```
