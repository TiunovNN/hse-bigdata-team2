# hse-bigdata-team2

## –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
–ù–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω python –∏ git

–î–ª—è Ubuntu 20.04 –¥–µ–ª–∞–µ–º —Ç–∞–∫:
```shell
$ sudo apt update && sudo apt install -y python3-pip python3-venv git
```

–ï—Å–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Ö–æ—Å—Ç–∞–º –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø–∞—Ä–æ–ª—å, –∞ –Ω–µ —á–µ—Ä–µ–∑ ssh-–∫–ª—é—á, —Ç–æ –Ω—É–∂–Ω–æ –µ—â–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞–∫–µ—Ç `sshpass`

```shell
$ sudo apt install -y sshpass
```

–°–∫–∞—á–∏–≤–∞–µ–º –∫–æ–¥ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:

```shell
$ git clone https://github.com/TiunovNN/hse-bigdata-team2.git
$ cd hse-bigdata-team2
```

### –ù–∞—Å—Ç—Ä–æ–∏—Ç—å ansible

–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º venv

```shell
~/hse-bigdata-team2$ python3 -m venv .venv
~/hse-bigdata-team2$ source .venv/bin/activate
~/hse-bigdata-team2$ python3 -m pip install -r requirements.txt
```

–ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ ansible –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ:

```shell
$ ansible --version
ansible [core 2.17.5]
```

### –ù–∞—Å—Ç—Ä–æ–∏—Ç—å ssh

–ö–æ –≤—Å–µ–º —É–∑–ª–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω ssh.

–ù–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Ç—Ä–µ—Ö —É–∑–ª–æ–≤ `~/.ssh/config`
```config
Host jumpnode
    HostName 192.168.1.10
    User team

Host node1
    HostName 192.168.1.11
    # ProxyJump jumpnode  # –µ—Å–ª–∏ –ø–æ–¥–∫–ª—é—á–∞–µ–º—Å—è —á–µ—Ä–µ–∑ jump-–Ω–æ–¥—É
    User team

Host node2
    HostName 192.168.1.12
    # ProxyJump jumpnode  # –µ—Å–ª–∏ –ø–æ–¥–∫–ª—é—á–∞–µ–º—Å—è —á–µ—Ä–µ–∑ jump-–Ω–æ–¥—É
    User team

Host node3
    HostName 192.168.1.13
    # ProxyJump jumpnode  # –µ—Å–ª–∏ –ø–æ–¥–∫–ª—é—á–∞–µ–º—Å—è —á–µ—Ä–µ–∑ jump-–Ω–æ–¥—É
    User team
```

### –ù–∞—Å—Ç—Ä–æ–∏—Ç—å inventory/hosts.yaml

–ï—Å–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏—è –Ω–æ–¥ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç —Ç–µ—Ö, —á—Ç–æ —É–∫–∞–∑–∞–Ω—ã –≤ [host.yaml](inventory/hosts.yaml), —Ç–æ —Ç–∞–º –Ω—É–∂–Ω–æ –ø–æ–¥—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è

–ï—Å–ª–∏ sudo –Ω–∞ —Ö–æ—Å—Ç–∞—Ö —Ç—Ä–µ–±—É–µ—Ç –≤–≤–æ–¥–∞ –ø–∞—Ä–æ–ª—è, —Ç–æ –Ω—É–∂–Ω–æ —Ä–∞—Å–∫–æ–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∫–∏ `#ansible_become_password: secretpassword` –∏ –∑–∞–º–µ–Ω–∏—Ç—å `secretpassword` –Ω–∞ —Å–≤–æ–π.

–ï—Å–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Ö–æ—Å—Ç–∞–º –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø–∞—Ä–æ–ª—å, –∞ –Ω–µ —á–µ—Ä–µ–∑ ssh-–∫–ª—é—á, —Ç–æ –Ω—É–∂–Ω–æ —Ä–∞—Å–∫–æ–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∫–∏ `#ansible_ssh_pass: secretpassword` –∏ –∑–∞–º–µ–Ω–∏—Ç—å `secretpassword` –Ω–∞ —Å–≤–æ–π.

–ù–∞–ø—Ä–∏–º–µ—Ä:
```yaml
datanodes:
  hosts:
    node1:
      ansible_become: yes
      ansible_user: team
      ansible_become_password: 'secretpassword'
      ansible_ssh_pass: 'secretpassword' # –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã
```

–ß—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—Å—è, —á—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏ –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É:

```shell
$ ansible -i inventory -m ping all
```

### –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ nginx

–ù–∞–ø–∏—à–∏—Ç–µ —Å–≤–æ–π –ø–∞—Ä–æ–ª—å –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ nginx –≤ —Ñ–∞–π–ª  [all.yaml](inventory/group_vars/all.yaml)

## Homework 1

### –û–ø–∏—Å–∞–Ω–∏–µ

1. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∫–ª–∞—Å—Ç–µ—Ä hdfs –≤–∫–ª—é—á–∞—é—â–∏–π –≤ —Å–µ–±—è 3 DataNode. –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω—ã –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –¥–µ–º–æ–Ω—ã: NameNode, Secondary NameNode –∏ —Ç—Ä–∏ DataNode
2. –ö–ª–∞—Å—Ç–µ—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω–∞—Ö, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –≤–∞–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ö–æ—Å—Ç–∞—Ö –ø–æ—è–≤–∏—Ç—Å—è –≤ —á–∞—Ç–µ –∫—É—Ä—Å–∞.
3. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–µ–º–æ–Ω–æ–≤ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —á–∏—Å–ª–∞ —Ö–æ—Å—Ç–æ–≤. –ë–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞, –∫–æ–≥–¥–∞ —Å—Ç–∞–Ω–µ—Ç –∏–∑–≤–µ—Å—Ç–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º—ã—Ö –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω.
4. –ö–ª–∞—Å—Ç–µ—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω—ã–º, –≤ –ª–æ–≥–∞—Ö –¥–µ–º–æ–Ω–æ–≤ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–π –æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö –∏ –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
–ö–∞–∫ –ø–æ–Ω—è—Ç—å, —á—Ç–æ –∫–ª–∞—Å—Ç–µ—Ä —Ü–µ–ª–æ—Å—Ç–Ω—ã–π:
–í–∞—Ä–∏–∞–Ω—Ç 1. –ó–∞–π—Ç–∏ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å NameNode –≤ Hadoop. –í –Ω–µ–º –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–µ–≥—Ä–∞–¥–∏—Ä–æ–≤–∞–≤—à–∏—Ö –Ω–æ–¥, –¥–æ–ª–∂–Ω—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–æ–≤–∞—Ç—å 3 —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö DataNode.
–í–∞—Ä–∏–∞–Ω—Ç 2. –í –ª–æ–≥–∞—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
5. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ: Ubuntu 20 –∏ Debian 10
6. –ù–∞ —É–∑–ª–∞—Ö –¥–æ–ª–∂–Ω–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –ø–æ ssh
7. –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã –±—É–¥—É—Ç —á–∏—Å—Ç—ã–µ. –ü–∏—à–∏—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Ç–∞–∫, –∫–∞–∫ –±—É–¥—Ç–æ –≤–∞–º –Ω—É–∂–Ω–æ –Ω–∞—É—á–∏—Ç—å –∫–æ–≥–æ-—Ç–æ —Ä–∞–∑–æ–≤—Ä–∞—á–∏–≤–∞—Ç—å –∫–ª–∞—Å—Ç–µ—Ä.
8. –≠—Ç–æ—Ç –∫–ª–∞—Å—Ç–µ—Ä –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞–Ω–∏–π

### –ó–∞–ø—É—Å–∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```shell
ansible-playbook -i inventory playbooks/configure_hdfs.yml
```


## Homework 2
–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å YARN –∏ –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –æ—Å–Ω–æ–≤–Ω—ã—Ö –∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–º–æ–Ω–æ–≤ –∫–ª–∞—Å—Ç–µ—Ä–∞ –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.
–ü–æ–¥–Ω—è—Ç—å yarn —Å history —Å–µ—Ä–≤–µ—Ä–æ–º –∏ –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å webui –≤—Å–µ—Ö –¥–∞—Ç–∞–Ω–æ–¥, –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –∫–ª–∞—Å—Ç–µ—Ä–∞ –∏ Historyjob —Å–µ—Ä–≤–µ—Ä–∞, —á—Ç–æ–±—ã –º—ã –º–æ–≥–ª–∏ –∏—Ö –≤–∏–¥–µ—Ç—å —á–µ—Ä–µ–∑ –æ–±—â–∏–π –≤–µ–± –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

### –ó–∞–ø—É—Å–∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```shell
ansible-playbook -i inventory playbooks/configure_yarn.yml
```

## Homework 3
–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ Apache Hive

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å hive
2. –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å Hive –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏–≥–æ–¥–Ω–æ–π –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–π —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏, —Ç.–µ.
—Å –æ—Ç–¥–µ–ª—å–Ω—ã–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö.
3. –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ hdfs
4. –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü—É Hive.
5. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –ø–æ–ª—É—á–µ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –≤ –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—É—é.


### –ó–∞–ø—É—Å–∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```shell
ansible-playbook -i inventory playbooks/configure_hive.yml
```

### –†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏

**TODO**

## Homework 4

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Apache Spark –ø–æ–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º YARN –¥–ª—è —á—Ç–µ–Ω–∏—è, —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ –∑–∞–ø–∏—Å–∏ –¥–∞–Ω–Ω—ã—Ö

* –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Å—Å–∏—é Apache Spark –ø–æ–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º YARN, —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞ –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∑–∞–¥–∞–Ω–∏—è—Ö
* –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –∫–ª–∞—Å—Ç–µ—Ä—É HDFS —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ–º—É –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∑–∞–¥–∞–Ω–∏—è—Ö
* –ò—Å–ø–æ–ª—å–∑—É—è —Å–æ–∑–¥–∞–Ω–Ω—É—é —Ä–∞–Ω–µ–µ —Å–µ—Å—Å–∏—é Spark –ø—Ä–æ—á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –Ω–∞ HDFS
* –ü—Ä–æ–≤–µ—Å—Ç–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∞–≥—Ä–µ–≥–∞—Ü–∏—é –∏–ª–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤)
* –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∫–∞–∫ —Ç–∞–±–ª–∏—Ü—É
* –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∫–ª–∏–µ–Ω—Ç hive –º–æ–∂–µ—Ç –ø—Ä–æ—á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ.
* –î–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –æ—Ü–µ–Ω–∫–∏: –ø—Ä–∏–º–µ–Ω–∏—Ç—å 5 —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π —Ä–∞–∑–Ω—ã—Ö –≤–∏–¥–æ–≤, —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∫–∞–∫ –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É.


### –ó–∞–ø—É—Å–∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```shell
ansible-playbook -i inventory playbooks/configure_spark.yml
```

### –†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏

## Homework 5

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —á—Ç–µ–Ω–∏—è, —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ –∑–∞–ø–∏—Å–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (Prefect –∏–ª–∏ Apache Airflow –ø–æ –≤—ã–±–æ—Ä—É)

üìå –í —Ä–∞–º–∫–∞—Ö –ø–æ—Ç–æ–∫–∞ (prefect) –∏–ª–∏ –û–ê–ì (Airflow)
* –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Å—Å–∏—é Apache Spark –ø–æ–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º YARN, —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞ –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∑–∞–¥–∞–Ω–∏—è—Ö
* –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –∫–ª–∞—Å—Ç–µ—Ä—É HDFS —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ–º—É –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∑–∞–¥–∞–Ω–∏—è—Ö
* –ò—Å–ø–æ–ª—å–∑—É—è —Å–æ–∑–¥–∞–Ω–Ω—É—é —Ä–∞–Ω–µ–µ —Å–µ—Å—Å–∏—é Spark, –ø—Ä–æ—á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –Ω–∞ HDFS
* –ü—Ä–æ–≤–µ—Å—Ç–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∞–≥—Ä–µ–≥–∞—Ü–∏—é –∏–ª–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤)
* –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∫–∞–∫ —Ç–∞–±–ª–∏—Ü—É


### –ó–∞–ø—É—Å–∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```shell
ansible-playbook -i inventory playbooks/configure_prefect.yml
```
–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ. 
–ß—Ç–æ–± –µ–≥–æ —É–±–∏—Ç—å, –Ω–∞–¥–æ –Ω–∞–π—Ç–∏ –µ–≥–æ PID —á–µ—Ä–µ–∑ `ps aux | grep python` –∏ —É–±–∏—Ç—å —á–µ—Ä–µ–∑ `kill PID`.
–õ—É—á—à–µ —Å–ø–æ—Å–æ–±–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É —Ñ–ª–æ—É –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ –±–µ–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –Ω–µ –ø—Ä–µ–¥–ª–æ–∂–∏–ª–∏ –¥–∞–∂–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏:
https://github.com/PrefectHQ/prefect/issues/11522#issuecomment-1976843871 


## Homework 6

### –ó–∞–¥–∞—á–∞
1. –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ GreenPlum, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –≤–∞—à–µ–º—É –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `user*`.
2. –í —Ç–∞–±–ª–∏—Ü–µ –¥–æ–ª–∂–Ω—ã –ª–µ–∂–∞—Ç—å —Ç–µ –∂–µ –¥–∞–Ω–Ω—ã–µ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∑–∞–Ω—è—Ç–∏—è—Ö.
3. –¢–∞–±–ª–∏—Ü–∞ –¥–æ–ª–∂–Ω–∞ —É—Å–ø–µ—à–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ –∑–∞–ø—Ä–æ—Å—É `SELECT`.

### –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è

#### –®–∞–≥ 1: –í—Ö–æ–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
```bash
ssh user@91.185.85.179
```

#### –®–∞–≥ 2: –ï—Å–ª–∏ bash –Ω–µ –≤–∏–¥–∏—Ç —É—Ç–∏–ª–∏—Ç—É `psql`, –≤—ã–ø–æ–ª–Ω—è–µ–º –∫–æ–º–∞–Ω–¥—É
```bash
source /usr/local/greenplum-db/greenplum_path.sh
```

#### –®–∞–≥ 3: –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
```bash
psql -d idp
```

#### –®–∞–≥ 4: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

**4.1** –ü–æ–¥–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:
```bash
wget https://raw.githubusercontent.com/TiunovNN/hse-bigdata-team2/master/sample_data.csv -O sample_data.csv
```

**4.2** –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ–º —Ñ–∞–π–ª:
```bash
mv sample_data.csv team-2-data.csv
```

**4.3** –°–æ–∑–¥–∞–µ–º –ø–∞–ø–∫—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
```bash
ssh user@91.185.85.179 "mkdir -p ~/team-2-data"
```

**4.4** –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä:
```bash
scp team-2-data.csv user@91.185.85.179:~/team-2-data/
```

#### –®–∞–≥ 5: –ó–∞–ø—É—Å–∫–∞–µ–º `gpfdist` –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –≤–∫–ª–∞–¥–∫–µ –∫–æ–Ω—Å–æ–ª–∏
```bash
cd ~/team-2-data/
gpfdist
```

#### –®–∞–≥ 6: –°–æ–∑–¥–∞–µ–º EXTERNAL —Ç–∞–±–ª–∏—Ü—É
```sql
CREATE EXTERNAL TABLE team_2_data_external (
    date TEXT,
    price_A DOUBLE PRECISION,
    price_B DOUBLE PRECISION,
    price_C DOUBLE PRECISION,
    price_D DOUBLE PRECISION,
    price_E DOUBLE PRECISION
)
LOCATION ('gpfdist://0.0.0.0:8080/team-2-data/team-2-data.csv')
FORMAT 'CSV' (DELIMITER ';' HEADER);
```

#### –®–∞–≥ 7: –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ EXTERNAL —Ç–∞–±–ª–∏—Ü–µ
```sql
SELECT * FROM team_2_data_external;
```

#### –®–∞–≥ 8: –°–æ–∑–¥–∞–µ–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é —Ç–∞–±–ª–∏—Ü—É (internal)
```sql
CREATE TABLE team_2_data_internal AS 
SELECT * FROM team_2_data_external;
```

#### –®–∞–≥ 9: –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Ç–∞–±–ª–∏—Ü–µ
```sql
SELECT * FROM team_2_data_internal;
```
